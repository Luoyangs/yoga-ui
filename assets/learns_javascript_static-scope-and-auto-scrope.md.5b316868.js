import{_ as n,r as s,c as a,a as t,w as e,f as c,e as o,o as p,b as l}from"./app.74c3daae.js";const u='{"title":"静态作用域与动态作用域","description":"","frontmatter":{},"headers":[{"level":2,"title":"作用域","slug":"作用域"},{"level":2,"title":"静态作用域与动态作用域","slug":"静态作用域与动态作用域-1"}],"relativePath":"learns/javascript/static-scope-and-auto-scrope.md","lastUpdated":1635388499005}',i={},r=c('<p><div class="table-of-contents"><ul><li><a href="#作用域">作用域</a></li><li><a href="#静态作用域与动态作用域">静态作用域与动态作用域</a></li></ul></div></p><h1 id="静态作用域与动态作用域" tabindex="-1">静态作用域与动态作用域 <a class="header-anchor" href="#静态作用域与动态作用域" aria-hidden="true">#</a></h1><h2 id="作用域" tabindex="-1">作用域 <a class="header-anchor" href="#作用域" aria-hidden="true">#</a></h2><p>作用域是指程序源代码中定义变量的区域。</p><p>作用域规定了如何查找变量，也就是确定当前执行代码对变量的访问权限。</p><p>JavaScript 采用词法作用域(lexical scoping)，也就是静态作用域。</p><h2 id="静态作用域与动态作用域-1" tabindex="-1">静态作用域与动态作用域 <a class="header-anchor" href="#静态作用域与动态作用域-1" aria-hidden="true">#</a></h2><ul><li>因为 JavaScript 采用的是词法作用域，函数的作用域在<code>函数定义</code>的时候就决定了。</li><li>而与词法作用域相对的是动态作用域，函数的作用域是在函数调用的时候才决定的。</li></ul>',8),k=o("div",{class:"language-js line-numbers-mode"},[o("pre",null,[o("code",null,[o("span",{class:"token keyword"},"var"),l(" value "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token number"},"1"),o("span",{class:"token punctuation"},";"),l("\n\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"foo"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),l(),o("span",{class:"token punctuation"},"{"),l("\n  console"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"log"),o("span",{class:"token punctuation"},"("),l("value"),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"bar"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),l(),o("span",{class:"token punctuation"},"{"),l("\n  "),o("span",{class:"token keyword"},"var"),l(" value "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token number"},"2"),o("span",{class:"token punctuation"},";"),l("\n  "),o("span",{class:"token function"},"foo"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n\n"),o("span",{class:"token function"},"bar"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l(),o("span",{class:"token comment"},"// 1"),l("\n")])]),o("div",{class:"line-numbers-wrapper"},[o("span",{class:"line-number"},"1"),o("br"),o("span",{class:"line-number"},"2"),o("br"),o("span",{class:"line-number"},"3"),o("br"),o("span",{class:"line-number"},"4"),o("br"),o("span",{class:"line-number"},"5"),o("br"),o("span",{class:"line-number"},"6"),o("br"),o("span",{class:"line-number"},"7"),o("br"),o("span",{class:"line-number"},"8"),o("br"),o("span",{class:"line-number"},"9"),o("br"),o("span",{class:"line-number"},"10"),o("br"),o("span",{class:"line-number"},"11"),o("br"),o("span",{class:"line-number"},"12"),o("br")])],-1),b=o("p",null,"假设JavaScript采用静态作用域，让我们分析下执行过程：",-1),m=o("p",null,"执行 foo 函数，先从 foo 函数内部查找是否有局部变量 value，如果没有，就根据书写的位置，查找上面一层的代码，也就是 value 等于 1，所以结果会打印 1。",-1),d=o("p",null,"假设JavaScript采用动态作用域，让我们分析下执行过程：",-1),f=o("p",null,"执行 foo 函数，依然是从 foo 函数内部查找是否有局部变量 value。如果没有，就从调用函数的作用域，也就是 bar 函数内部查找 value 变量，所以结果会打印 2。",-1),v=o("p",null,"前面我们已经说了，JavaScript采用的是静态作用域，所以这个例子的结果是 1。",-1),w=o("div",{class:"language-js line-numbers-mode"},[o("pre",null,[o("code",null,[o("span",{class:"token keyword"},"var"),l(" value "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token number"},"1"),o("span",{class:"token punctuation"},";"),l("\n\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"bar"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),l(),o("span",{class:"token punctuation"},"{"),l("\n  "),o("span",{class:"token keyword"},"var"),l(" value "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token number"},"2"),o("span",{class:"token punctuation"},";"),l("\n\n  "),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"foo"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),l(),o("span",{class:"token punctuation"},"{"),l("\n    console"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"log"),o("span",{class:"token punctuation"},"("),l("value"),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\n  "),o("span",{class:"token punctuation"},"}"),l("\n  "),o("span",{class:"token function"},"foo"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n\n"),o("span",{class:"token function"},"bar"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l(),o("span",{class:"token comment"},"// 2"),l("\n")])]),o("div",{class:"line-numbers-wrapper"},[o("span",{class:"line-number"},"1"),o("br"),o("span",{class:"line-number"},"2"),o("br"),o("span",{class:"line-number"},"3"),o("br"),o("span",{class:"line-number"},"4"),o("br"),o("span",{class:"line-number"},"5"),o("br"),o("span",{class:"line-number"},"6"),o("br"),o("span",{class:"line-number"},"7"),o("br"),o("span",{class:"line-number"},"8"),o("br"),o("span",{class:"line-number"},"9"),o("br"),o("span",{class:"line-number"},"10"),o("br"),o("span",{class:"line-number"},"11"),o("br"),o("span",{class:"line-number"},"12"),o("br")])],-1),h=o("p",null,"最后，让我们看一个《JavaScript权威指南》中的例子：",-1),g=o("div",{class:"language-js line-numbers-mode"},[o("pre",null,[o("code",null,[o("span",{class:"token keyword"},"var"),l(" scope "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token string"},'"global scope"'),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"checkscope"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"{"),l("\n    "),o("span",{class:"token keyword"},"var"),l(" scope "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token string"},'"local scope"'),o("span",{class:"token punctuation"},";"),l("\n    "),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"f"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"{"),l("\n        "),o("span",{class:"token keyword"},"return"),l(" scope"),o("span",{class:"token punctuation"},";"),l("\n    "),o("span",{class:"token punctuation"},"}"),l("\n    "),o("span",{class:"token keyword"},"return"),l(),o("span",{class:"token function"},"f"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n"),o("span",{class:"token function"},"checkscope"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l(),o("span",{class:"token comment"},"// local scope"),l("\n")])]),o("div",{class:"line-numbers-wrapper"},[o("span",{class:"line-number"},"1"),o("br"),o("span",{class:"line-number"},"2"),o("br"),o("span",{class:"line-number"},"3"),o("br"),o("span",{class:"line-number"},"4"),o("br"),o("span",{class:"line-number"},"5"),o("br"),o("span",{class:"line-number"},"6"),o("br"),o("span",{class:"line-number"},"7"),o("br"),o("span",{class:"line-number"},"8"),o("br"),o("span",{class:"line-number"},"9"),o("br")])],-1),y=o("div",{class:"language-js line-numbers-mode"},[o("pre",null,[o("code",null,[o("span",{class:"token keyword"},"var"),l(" scope "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token string"},'"global scope"'),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"checkscope"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"{"),l("\n  "),o("span",{class:"token keyword"},"var"),l(" scope "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token string"},'"local scope"'),o("span",{class:"token punctuation"},";"),l("\n  "),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"f"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"{"),l("\n    "),o("span",{class:"token keyword"},"return"),l(" scope"),o("span",{class:"token punctuation"},";"),l("\n  "),o("span",{class:"token punctuation"},"}"),l("\n  "),o("span",{class:"token keyword"},"return"),l(" f"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n"),o("span",{class:"token function"},"checkscope"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l(),o("span",{class:"token comment"},"// local scope"),l("\n")])]),o("div",{class:"line-numbers-wrapper"},[o("span",{class:"line-number"},"1"),o("br"),o("span",{class:"line-number"},"2"),o("br"),o("span",{class:"line-number"},"3"),o("br"),o("span",{class:"line-number"},"4"),o("br"),o("span",{class:"line-number"},"5"),o("br"),o("span",{class:"line-number"},"6"),o("br"),o("span",{class:"line-number"},"7"),o("br"),o("span",{class:"line-number"},"8"),o("br"),o("span",{class:"line-number"},"9"),o("br")])],-1),_=o("p",null,"虽然两段代码执行的结果一样，但是两段代码究竟有哪些不同呢？",-1),S=o("p",null,"答案就是执行上下文栈的变化不一样。",-1),C=o("p",null,"让我们模拟第一段代码：",-1),A=o("div",{class:"language-js line-numbers-mode"},[o("pre",null,[o("code",null,[l("ECStack"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"push"),o("span",{class:"token punctuation"},"("),o("span",{class:"token operator"},"<"),l("checkscope"),o("span",{class:"token operator"},">"),l(" functionContext"),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\nECStack"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"push"),o("span",{class:"token punctuation"},"("),o("span",{class:"token operator"},"<"),l("f"),o("span",{class:"token operator"},">"),l(" functionContext"),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\nECStack"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"pop"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\nECStack"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"pop"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\n")])]),o("div",{class:"line-numbers-wrapper"},[o("span",{class:"line-number"},"1"),o("br"),o("span",{class:"line-number"},"2"),o("br"),o("span",{class:"line-number"},"3"),o("br"),o("span",{class:"line-number"},"4"),o("br")])],-1),j=o("p",null,"让我们模拟第二段代码：",-1),x=o("div",{class:"language-js line-numbers-mode"},[o("pre",null,[o("code",null,[l("ECStack"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"push"),o("span",{class:"token punctuation"},"("),o("span",{class:"token operator"},"<"),l("checkscope"),o("span",{class:"token operator"},">"),l(" functionContext"),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\nECStack"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"pop"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\nECStack"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"push"),o("span",{class:"token punctuation"},"("),o("span",{class:"token operator"},"<"),l("f"),o("span",{class:"token operator"},">"),l(" functionContext"),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\nECStack"),o("span",{class:"token punctuation"},"."),o("span",{class:"token function"},"pop"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\n")])]),o("div",{class:"line-numbers-wrapper"},[o("span",{class:"line-number"},"1"),o("br"),o("span",{class:"line-number"},"2"),o("br"),o("span",{class:"line-number"},"3"),o("br"),o("span",{class:"line-number"},"4"),o("br")])],-1),E=o("p",null,"再看看下面这个简单的例子",-1),J=o("div",{class:"language-js line-numbers-mode"},[o("pre",null,[o("code",null,[o("span",{class:"token keyword"},"var"),l(" scope "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token string"},'"global scope"'),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"f"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"{"),l("\n  "),o("span",{class:"token keyword"},"return"),l(" scope"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"checkscope"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"{"),l("\n  "),o("span",{class:"token keyword"},"var"),l(" scope "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token string"},'"local scope"'),o("span",{class:"token punctuation"},";"),l("\n  \n  "),o("span",{class:"token keyword"},"return"),l(" f"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n"),o("span",{class:"token function"},"checkscope"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l(),o("span",{class:"token comment"},"// global scope"),l("\n")])]),o("div",{class:"line-numbers-wrapper"},[o("span",{class:"line-number"},"1"),o("br"),o("span",{class:"line-number"},"2"),o("br"),o("span",{class:"line-number"},"3"),o("br"),o("span",{class:"line-number"},"4"),o("br"),o("span",{class:"line-number"},"5"),o("br"),o("span",{class:"line-number"},"6"),o("br"),o("span",{class:"line-number"},"7"),o("br"),o("span",{class:"line-number"},"8"),o("br"),o("span",{class:"line-number"},"9"),o("br"),o("span",{class:"line-number"},"10"),o("br")])],-1),T=o("div",{class:"language-js line-numbers-mode"},[o("pre",null,[o("code",null,[o("span",{class:"token keyword"},"var"),l(" scope "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token string"},'"global scope"'),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"f"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"{"),l("\n  "),o("span",{class:"token keyword"},"return"),l(" scope"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n"),o("span",{class:"token keyword"},"function"),l(),o("span",{class:"token function"},"checkscope"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},"{"),l("\n  "),o("span",{class:"token keyword"},"var"),l(" scope "),o("span",{class:"token operator"},"="),l(),o("span",{class:"token string"},'"local scope"'),o("span",{class:"token punctuation"},";"),l("\n  \n  "),o("span",{class:"token keyword"},"return"),l(),o("span",{class:"token function"},"f"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l("\n"),o("span",{class:"token punctuation"},"}"),l("\n"),o("span",{class:"token function"},"checkscope"),o("span",{class:"token punctuation"},"("),o("span",{class:"token punctuation"},")"),o("span",{class:"token punctuation"},";"),l(),o("span",{class:"token comment"},"// global scope"),l("\n")])]),o("div",{class:"line-numbers-wrapper"},[o("span",{class:"line-number"},"1"),o("br"),o("span",{class:"line-number"},"2"),o("br"),o("span",{class:"line-number"},"3"),o("br"),o("span",{class:"line-number"},"4"),o("br"),o("span",{class:"line-number"},"5"),o("br"),o("span",{class:"line-number"},"6"),o("br"),o("span",{class:"line-number"},"7"),o("br"),o("span",{class:"line-number"},"8"),o("br"),o("span",{class:"line-number"},"9"),o("br"),o("span",{class:"line-number"},"10"),o("br")])],-1);var P=n(i,[["render",function(n,c,o,l,u,i){const P=s("code-block");return p(),a("div",null,[r,t(P,{showAction:!1},{default:e((()=>[k])),_:1}),b,m,d,f,v,t(P,{showAction:!1},{default:e((()=>[w])),_:1}),h,t(P,{showAction:!1},{default:e((()=>[g])),_:1}),t(P,{showAction:!1},{default:e((()=>[y])),_:1}),_,S,C,t(P,{showAction:!1},{default:e((()=>[A])),_:1}),j,t(P,{showAction:!1},{default:e((()=>[x])),_:1}),E,t(P,{showAction:!1},{default:e((()=>[J])),_:1}),t(P,{showAction:!1},{default:e((()=>[T])),_:1})])}]]);export{u as __pageData,P as default};
