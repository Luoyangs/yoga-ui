import{_ as a,r as s,c as l,a as e,w as n,f as p,e as r,b as i,o as t}from"./app.82084a0b.js";const u='{"title":"阿里云服务器搭建GItLab以后出现卡顿","description":"","frontmatter":{},"headers":[{"level":2,"title":"一、原因分析","slug":"一、原因分析"},{"level":2,"title":"二、解决方法","slug":"二、解决方法"},{"level":2,"title":"可能出现的问题","slug":"可能出现的问题"}],"relativePath":"learns/deploy/aliyun-deploy-gitlab-frozen.md","lastUpdated":1638452551944}',c={},d=p('',7),o=r("div",{class:"language-"},[r("pre",null,[r("code",null,"cat /proc/swaps\n")]),r("div",{class:"line-numbers-wrapper"},[r("span",{class:"line-number"},"1"),r("br")])],-1),w=r("p",null,"结果并没有swap分区",-1),b=r("h2",{id:"二、解决方法",tabindex:"-1"},[i("二、解决方法 "),r("a",{class:"header-anchor",href:"#二、解决方法","aria-hidden":"true"},"#")],-1),h=r("p",null,"1、创建 swap 分区（这里需要等待几秒）",-1),m=r("div",{class:"language-"},[r("pre",null,[r("code",null,"dd if=/dev/zero of=/data/swap bs=512 count=8388616\n")]),r("div",{class:"line-numbers-wrapper"},[r("span",{class:"line-number"},"1"),r("br")])],-1),f=r("p",null,"注意：创建swap大小为bs*count=4294971392(4G)，/data/swap目录若无则找/mnt/swap(我使用的是下面的指令生效)",-1),v=r("div",{class:"language-"},[r("pre",null,[r("code",null,"dd if=/dev/zero of=/mnt/swap bs=512 count=8388616\n")]),r("div",{class:"line-numbers-wrapper"},[r("span",{class:"line-number"},"1"),r("br")])],-1),g=r("p",null,"2、通过mkswap命令将上面新建出的文件做成swap分区",-1),_=r("div",{class:"language-"},[r("pre",null,[r("code",null,"mkswap /mnt/swap\n")]),r("div",{class:"line-numbers-wrapper"},[r("span",{class:"line-number"},"1"),r("br")])],-1),A=r("p",null,"3、查看内核参数vm.swappiness中的数值是否为0，如果为0则根据实际需要调整成60。查看参数：",-1),y=r("div",{class:"language-"},[r("pre",null,[r("code",null,"cat /proc/sys/vm/swappiness\n")]),r("div",{class:"line-numbers-wrapper"},[r("span",{class:"line-number"},"1"),r("br")])],-1),T=r("p",null,"设置参数：",-1),x=r("div",{class:"language-"},[r("pre",null,[r("code",null,"sysctl -w vm.swappiness=60\n")]),r("div",{class:"line-numbers-wrapper"},[r("span",{class:"line-number"},"1"),r("br")])],-1),G=r("p",null,"启用 swap 分区",-1),I=r("div",{class:"language-"},[r("pre",null,[r("code",null,"swapon /mnt/swap\necho “/mnt/swap swap swap defaults 0 0” >> /etc/fstab\n")]),r("div",{class:"line-numbers-wrapper"},[r("span",{class:"line-number"},"1"),r("br"),r("span",{class:"line-number"},"2"),r("br")])],-1),k=r("p",null,"5、再次使用cat /proc/swaps 查看swap分区是否启动。可以看到，swap分区已经启用，现在通过 gitlab 进行操作会发现很流畅！",-1),z=r("h2",{id:"可能出现的问题",tabindex:"-1"},[i("可能出现的问题 "),r("a",{class:"header-anchor",href:"#可能出现的问题","aria-hidden":"true"},"#")],-1),P=r("p",null,[i("当时可能gitlab运行没问题，后续的时候发现swap分区并未执行，可以试一下永久修改，则编辑"),r("code",null,"/etc/sysctl.conf"),i("文件，将vm.swappiness改为30或者60")],-1);var S=a(c,[["render",function(a,p,r,i,u,c){const S=s("code-block");return t(),l("div",null,[d,e(S,{showAction:!1},{default:n((()=>[o])),_:1}),w,b,h,e(S,{showAction:!1},{default:n((()=>[m])),_:1}),f,e(S,{showAction:!1},{default:n((()=>[v])),_:1}),g,e(S,{showAction:!1},{default:n((()=>[_])),_:1}),A,e(S,{showAction:!1},{default:n((()=>[y])),_:1}),T,e(S,{showAction:!1},{default:n((()=>[x])),_:1}),G,e(S,{showAction:!1},{default:n((()=>[I])),_:1}),k,z,P])}]]);export{u as __pageData,S as default};
