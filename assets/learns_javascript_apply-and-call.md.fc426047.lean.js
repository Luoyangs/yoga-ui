import{_ as n,r as s,c as a,a as t,w as e,f as o,e as c,b as l,o as p}from"./app.de0c49ac.js";const u='{"title":"模拟实现JS的apply&call方法","description":"","frontmatter":{},"headers":[{"level":2,"title":"注意两点：","slug":"注意两点："},{"level":2,"title":"模拟实现第一步","slug":"模拟实现第一步"},{"level":2,"title":"模拟实现第二步","slug":"模拟实现第二步"},{"level":2,"title":"模拟实现第三步","slug":"模拟实现第三步"},{"level":2,"title":"apply的模拟实现","slug":"apply的模拟实现"}],"relativePath":"learns/javascript/apply-and-call.md","lastUpdated":1635308878158}',r={},i=o('',3),k=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token keyword"},"var"),l(" foo "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"{"),l("\n  value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token number"},"1"),l("\n"),c("span",{class:"token punctuation"},"}"),c("span",{class:"token punctuation"},";"),l("\n\n"),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"call"),c("span",{class:"token punctuation"},"("),l("foo"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l(),c("span",{class:"token comment"},"// 1"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br")])],-1),b=c("h2",{id:"注意两点：",tabindex:"-1"},[l("注意两点： "),c("a",{class:"header-anchor",href:"#注意两点：","aria-hidden":"true"},"#")],-1),m=c("ul",null,[c("li",null,"call 改变了 this 的指向，指向到 foo"),c("li",null,"bar 函数执行了")],-1),d=c("h2",{id:"模拟实现第一步",tabindex:"-1"},[l("模拟实现第一步 "),c("a",{class:"header-anchor",href:"#模拟实现第一步","aria-hidden":"true"},"#")],-1),f=c("p",null,"那么我们该怎么模拟实现这两个效果呢？",-1),g=c("p",null,"试想当调用 call 的时候，把 foo 对象改造成如下：",-1),v=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token keyword"},"var"),l(" foo "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"{"),l("\n  value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token number"},"1"),c("span",{class:"token punctuation"},","),l("\n  "),c("span",{class:"token function-variable function"},"bar"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token keyword"},"function"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n    console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},")"),l("\n  "),c("span",{class:"token punctuation"},"}"),l("\n"),c("span",{class:"token punctuation"},"}"),c("span",{class:"token punctuation"},";"),l("\n\nfoo"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l(),c("span",{class:"token comment"},"// 1"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br")])],-1),w=c("p",null,"所以我们模拟的步骤可以分为：",-1),y=c("ul",null,[c("li",null,"将函数设为对象的属性"),c("li",null,"执行该函数"),c("li",null,"删除该函数")],-1),h=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token comment"},"// 第一版"),l("\n"),c("span",{class:"token class-name"},"Function"),c("span",{class:"token punctuation"},"."),l("prototype"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function-variable function"},"call2"),l(),c("span",{class:"token operator"},"="),l(),c("span",{class:"token keyword"},"function"),c("span",{class:"token punctuation"},"("),c("span",{class:"token parameter"},"context"),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  "),c("span",{class:"token comment"},"// 首先要获取调用call的函数，用this可以获取"),l("\n  context"),c("span",{class:"token punctuation"},"."),l("fn "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},";"),l("\n  context"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"fn"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token keyword"},"delete"),l(" context"),c("span",{class:"token punctuation"},"."),l("fn"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token comment"},"// 测试一下"),l("\n"),c("span",{class:"token keyword"},"var"),l(" foo "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"{"),l("\n  value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token number"},"1"),l("\n"),c("span",{class:"token punctuation"},"}"),c("span",{class:"token punctuation"},";"),l("\n\n"),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\nbar"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"call2"),c("span",{class:"token punctuation"},"("),l("foo"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l(),c("span",{class:"token comment"},"// 1"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br"),c("span",{class:"line-number"},"15"),c("br"),c("span",{class:"line-number"},"16"),c("br"),c("span",{class:"line-number"},"17"),c("br"),c("span",{class:"line-number"},"18"),c("br")])],-1),x=c("h2",{id:"模拟实现第二步",tabindex:"-1"},[l("模拟实现第二步 "),c("a",{class:"header-anchor",href:"#模拟实现第二步","aria-hidden":"true"},"#")],-1),j=c("p",null,"call 函数还能给定参数执行函数",-1),_=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token keyword"},"var"),l(" foo "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"{"),l("\n  value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token number"},"1"),l("\n"),c("span",{class:"token punctuation"},"}"),c("span",{class:"token punctuation"},";"),l("\n\n"),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"("),c("span",{class:"token parameter"},[l("name"),c("span",{class:"token punctuation"},","),l(" age")]),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),l("name"),c("span",{class:"token punctuation"},")"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),l("age"),c("span",{class:"token punctuation"},")"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"call"),c("span",{class:"token punctuation"},"("),l("foo"),c("span",{class:"token punctuation"},","),l(),c("span",{class:"token string"},"'kevin'"),c("span",{class:"token punctuation"},","),l(),c("span",{class:"token number"},"18"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token comment"},"// kevin"),l("\n"),c("span",{class:"token comment"},"// 18"),l("\n"),c("span",{class:"token comment"},"// 1"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br")])],-1),A=c("blockquote",null,[c("p",null,"注意：传入的参数并不确定")],-1),S=c("p",null,"我们可以从 Arguments 对象中取值，取出第二个到最后一个参数，然后放到一个数组里。",-1),F=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token comment"},"// 以上个例子为例，此时的arguments为："),l("\n"),c("span",{class:"token comment"},"// arguments = {"),l("\n"),c("span",{class:"token comment"},"//      0: foo,"),l("\n"),c("span",{class:"token comment"},"//      1: 'kevin',"),l("\n"),c("span",{class:"token comment"},"//      2: 18,"),l("\n"),c("span",{class:"token comment"},"//      length: 3"),l("\n"),c("span",{class:"token comment"},"// }"),l("\n"),c("span",{class:"token comment"},"// 因为arguments是类数组对象，所以可以用for循环"),l("\n"),c("span",{class:"token keyword"},"var"),l(" args "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"["),c("span",{class:"token punctuation"},"]"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token keyword"},"for"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"var"),l(" i "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token number"},"1"),c("span",{class:"token punctuation"},","),l(" len "),c("span",{class:"token operator"},"="),l(" arguments"),c("span",{class:"token punctuation"},"."),l("length"),c("span",{class:"token punctuation"},";"),l(" i "),c("span",{class:"token operator"},"<"),l(" len"),c("span",{class:"token punctuation"},";"),l(" i"),c("span",{class:"token operator"},"++"),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  "),c("span",{class:"token comment"},"// args.push('arguments[' + i + ']');"),l("\n  args"),c("span",{class:"token punctuation"},"["),l("i"),c("span",{class:"token operator"},"-"),c("span",{class:"token number"},"1"),c("span",{class:"token punctuation"},"]"),l(),c("span",{class:"token operator"},"="),l(),c("span",{class:"token string"},"'arguments['"),l(),c("span",{class:"token operator"},"+"),l(" i "),c("span",{class:"token operator"},"+"),l(),c("span",{class:"token string"},"']'"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token comment"},'// 执行后 args为 ["arguments[1]", "arguments[2]", "arguments[3]"]'),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br"),c("span",{class:"line-number"},"15"),c("br")])],-1),O=c("p",null,"不定长的参数问题解决了，我们接着要把这个参数数组放到要执行的函数的参数里面去。",-1),T=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token comment"},"// 将数组里的元素作为多个参数放进函数的形参里"),l("\ncontext"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"fn"),c("span",{class:"token punctuation"},"("),l("args"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"join"),c("span",{class:"token punctuation"},"("),c("span",{class:"token string"},"','"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},")"),l("\n"),c("span",{class:"token comment"},"// (O_o)??"),l("\n"),c("span",{class:"token comment"},"// 这个方法肯定是不行的啦！！！"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br")])],-1),E=c("p",null,"也许有人想到用 ES6 的方法，不过 call 是 ES3 的方法，我们为了模拟实现一个 ES3 的方法，要用到ES6的方法，好像……，嗯，也可以啦。但是我们这次用 eval 方法拼成一个函数，类似于这样：",-1),q=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token function"},"eval"),c("span",{class:"token punctuation"},"("),c("span",{class:"token string"},"'context.fn('"),l(),c("span",{class:"token operator"},"+"),l(" args "),c("span",{class:"token operator"},"+"),c("span",{class:"token string"},"')'"),c("span",{class:"token punctuation"},")"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br")])],-1),P=c("p",null,"这里 args 会自动调用 Array.toString() 这个方法。",-1),C=c("p",null,"所以我们的第二版克服了两个大问题，代码如下：",-1),I=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token comment"},"// 第二版"),l("\n"),c("span",{class:"token class-name"},"Function"),c("span",{class:"token punctuation"},"."),l("prototype"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function-variable function"},"call2"),l(),c("span",{class:"token operator"},"="),l(),c("span",{class:"token keyword"},"function"),c("span",{class:"token punctuation"},"("),c("span",{class:"token parameter"},"context"),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  context"),c("span",{class:"token punctuation"},"."),l("fn "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token keyword"},"var"),l(" args "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"["),c("span",{class:"token punctuation"},"]"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token keyword"},"for"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"var"),l(" i "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token number"},"1"),c("span",{class:"token punctuation"},","),l(" len "),c("span",{class:"token operator"},"="),l(" arguments"),c("span",{class:"token punctuation"},"."),l("length"),c("span",{class:"token punctuation"},";"),l(" i "),c("span",{class:"token operator"},"<"),l(" len"),c("span",{class:"token punctuation"},";"),l(" i"),c("span",{class:"token operator"},"++"),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n    "),c("span",{class:"token comment"},"// args.push('arguments[' + i + ']');"),l("\n    args"),c("span",{class:"token punctuation"},"["),l("i "),c("span",{class:"token operator"},"-"),l(),c("span",{class:"token number"},"1"),c("span",{class:"token punctuation"},"]"),l(),c("span",{class:"token operator"},"="),l(),c("span",{class:"token string"},"'arguments['"),l(),c("span",{class:"token operator"},"+"),l(" i "),c("span",{class:"token operator"},"+"),l(),c("span",{class:"token string"},"']'"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token punctuation"},"}"),l("\n  "),c("span",{class:"token function"},"eval"),c("span",{class:"token punctuation"},"("),c("span",{class:"token string"},"'context.fn('"),l(),c("span",{class:"token operator"},"+"),l(" args "),c("span",{class:"token operator"},"+"),c("span",{class:"token string"},"')'"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token keyword"},"delete"),l(" context"),c("span",{class:"token punctuation"},"."),l("fn"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token comment"},"// 测试一下"),l("\n"),c("span",{class:"token keyword"},"var"),l(" foo "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"{"),l("\n  value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token number"},"1"),l("\n"),c("span",{class:"token punctuation"},"}"),c("span",{class:"token punctuation"},";"),l("\n\n"),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"("),c("span",{class:"token parameter"},[l("name"),c("span",{class:"token punctuation"},","),l(" age")]),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),l("name"),c("span",{class:"token punctuation"},")"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),l("age"),c("span",{class:"token punctuation"},")"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\nbar"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"call2"),c("span",{class:"token punctuation"},"("),l("foo"),c("span",{class:"token punctuation"},","),l(),c("span",{class:"token string"},"'kevin'"),c("span",{class:"token punctuation"},","),l(),c("span",{class:"token number"},"18"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l(" \n"),c("span",{class:"token comment"},"// kevin"),l("\n"),c("span",{class:"token comment"},"// 18"),l("\n"),c("span",{class:"token comment"},"// 1"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br"),c("span",{class:"line-number"},"15"),c("br"),c("span",{class:"line-number"},"16"),c("br"),c("span",{class:"line-number"},"17"),c("br"),c("span",{class:"line-number"},"18"),c("br"),c("span",{class:"line-number"},"19"),c("br"),c("span",{class:"line-number"},"20"),c("br"),c("span",{class:"line-number"},"21"),c("br"),c("span",{class:"line-number"},"22"),c("br"),c("span",{class:"line-number"},"23"),c("br"),c("span",{class:"line-number"},"24"),c("br"),c("span",{class:"line-number"},"25"),c("br"),c("span",{class:"line-number"},"26"),c("br"),c("span",{class:"line-number"},"27"),c("br")])],-1),J=c("h2",{id:"模拟实现第三步",tabindex:"-1"},[l("模拟实现第三步 "),c("a",{class:"header-anchor",href:"#模拟实现第三步","aria-hidden":"true"},"#")],-1),V=c("p",null,"模拟代码已经完成 80%，还有两个小点要注意：",-1),D=c("p",null,"1.this 参数可以传 null，当为 null 的时候，视为指向 window",-1),N=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token keyword"},"var"),l(" value "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token number"},"1"),c("span",{class:"token punctuation"},";"),l("\n\n"),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"call"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"null"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l(),c("span",{class:"token comment"},"// 1"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br")])],-1),R=c("p",null,"2.函数是可以有返回值的！",-1),U=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token keyword"},"var"),l(" obj "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"{"),l("\n  value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token number"},"1"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"("),c("span",{class:"token parameter"},[l("name"),c("span",{class:"token punctuation"},","),l(" age")]),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  "),c("span",{class:"token keyword"},"return"),l(),c("span",{class:"token punctuation"},"{"),l("\n    value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},","),l("\n    name"),c("span",{class:"token operator"},":"),l(" name"),c("span",{class:"token punctuation"},","),l("\n    age"),c("span",{class:"token operator"},":"),l(" age\n  "),c("span",{class:"token punctuation"},"}"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\nconsole"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"call"),c("span",{class:"token punctuation"},"("),l("obj"),c("span",{class:"token punctuation"},","),l(),c("span",{class:"token string"},"'kevin'"),c("span",{class:"token punctuation"},","),l(),c("span",{class:"token number"},"18"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token comment"},"// Object {"),l("\n"),c("span",{class:"token comment"},"//    value: 1,"),l("\n"),c("span",{class:"token comment"},"//    name: 'kevin',"),l("\n"),c("span",{class:"token comment"},"//    age: 18"),l("\n"),c("span",{class:"token comment"},"// }"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br"),c("span",{class:"line-number"},"15"),c("br"),c("span",{class:"line-number"},"16"),c("br"),c("span",{class:"line-number"},"17"),c("br"),c("span",{class:"line-number"},"18"),c("br")])],-1),z=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token comment"},"// 第三版"),l("\n"),c("span",{class:"token class-name"},"Function"),c("span",{class:"token punctuation"},"."),l("prototype"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function-variable function"},"call2"),l(),c("span",{class:"token operator"},"="),l(),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token punctuation"},"("),c("span",{class:"token parameter"},"context"),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  "),c("span",{class:"token keyword"},"var"),l(" context "),c("span",{class:"token operator"},"="),l(" context "),c("span",{class:"token operator"},"||"),l(" window"),c("span",{class:"token punctuation"},";"),l("\n  context"),c("span",{class:"token punctuation"},"."),l("fn "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},";"),l("\n\n  "),c("span",{class:"token keyword"},"var"),l(" args "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"["),c("span",{class:"token punctuation"},"]"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token keyword"},"for"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"var"),l(" i "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token number"},"1"),c("span",{class:"token punctuation"},","),l(" len "),c("span",{class:"token operator"},"="),l(" arguments"),c("span",{class:"token punctuation"},"."),l("length"),c("span",{class:"token punctuation"},";"),l(" i "),c("span",{class:"token operator"},"<"),l(" len"),c("span",{class:"token punctuation"},";"),l(" i"),c("span",{class:"token operator"},"++"),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n    "),c("span",{class:"token comment"},"// args.push('arguments[' + i + ']');"),l("\n    args"),c("span",{class:"token punctuation"},"["),l("i "),c("span",{class:"token operator"},"-"),l(),c("span",{class:"token number"},"1"),c("span",{class:"token punctuation"},"]"),l(),c("span",{class:"token operator"},"="),l(),c("span",{class:"token string"},"'arguments['"),l(),c("span",{class:"token operator"},"+"),l(" i "),c("span",{class:"token operator"},"+"),l(),c("span",{class:"token string"},"']'"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token punctuation"},"}"),l("\n\n  "),c("span",{class:"token keyword"},"var"),l(" result "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token function"},"eval"),c("span",{class:"token punctuation"},"("),c("span",{class:"token string"},"'context.fn('"),l(),c("span",{class:"token operator"},"+"),l(" args "),c("span",{class:"token operator"},"+"),c("span",{class:"token string"},"')'"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token comment"},"// var result = new Function('context', 'arguments', 'return context.fn(' + args + ')')(context, arguments); "),l("\n  "),c("span",{class:"token comment"},"// 上面使用new Function相当于var binderFn = new Function('context', 'arguments', 'return context.fn(' + args + ')');"),l("\n  "),c("span",{class:"token comment"},"// var result = binderFn(context, arguments);"),l("\n  "),c("span",{class:"token comment"},"// args = ['arguments[0]','arguments[1]', 'arguments[2]']..."),l("\n\n  "),c("span",{class:"token keyword"},"delete"),l(" context"),c("span",{class:"token punctuation"},"."),l("fn\n  "),c("span",{class:"token keyword"},"return"),l(" result"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token comment"},"// 测试一下"),l("\n"),c("span",{class:"token keyword"},"var"),l(" value "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token number"},"2"),c("span",{class:"token punctuation"},";"),l("\n\n"),c("span",{class:"token keyword"},"var"),l(" obj "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"{"),l("\n  value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token number"},"1"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\n"),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token function"},"bar"),c("span",{class:"token punctuation"},"("),c("span",{class:"token parameter"},[l("name"),c("span",{class:"token punctuation"},","),l(" age")]),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  console"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token keyword"},"return"),l(),c("span",{class:"token punctuation"},"{"),l("\n    value"),c("span",{class:"token operator"},":"),l(),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},"."),l("value"),c("span",{class:"token punctuation"},","),l("\n    name"),c("span",{class:"token operator"},":"),l(" name"),c("span",{class:"token punctuation"},","),l("\n    age"),c("span",{class:"token operator"},":"),l(" age\n  "),c("span",{class:"token punctuation"},"}"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n\nbar"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"call2"),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"null"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l(),c("span",{class:"token comment"},"// 2"),l("\n\nconsole"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"log"),c("span",{class:"token punctuation"},"("),l("bar"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"call2"),c("span",{class:"token punctuation"},"("),l("obj"),c("span",{class:"token punctuation"},","),l(),c("span",{class:"token string"},"'kevin'"),c("span",{class:"token punctuation"},","),l(),c("span",{class:"token number"},"18"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token comment"},"// 1"),l("\n"),c("span",{class:"token comment"},"// Object {"),l("\n"),c("span",{class:"token comment"},"//    value: 1,"),l("\n"),c("span",{class:"token comment"},"//    name: 'kevin',"),l("\n"),c("span",{class:"token comment"},"//    age: 18"),l("\n"),c("span",{class:"token comment"},"// }"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br"),c("span",{class:"line-number"},"15"),c("br"),c("span",{class:"line-number"},"16"),c("br"),c("span",{class:"line-number"},"17"),c("br"),c("span",{class:"line-number"},"18"),c("br"),c("span",{class:"line-number"},"19"),c("br"),c("span",{class:"line-number"},"20"),c("br"),c("span",{class:"line-number"},"21"),c("br"),c("span",{class:"line-number"},"22"),c("br"),c("span",{class:"line-number"},"23"),c("br"),c("span",{class:"line-number"},"24"),c("br"),c("span",{class:"line-number"},"25"),c("br"),c("span",{class:"line-number"},"26"),c("br"),c("span",{class:"line-number"},"27"),c("br"),c("span",{class:"line-number"},"28"),c("br"),c("span",{class:"line-number"},"29"),c("br"),c("span",{class:"line-number"},"30"),c("br"),c("span",{class:"line-number"},"31"),c("br"),c("span",{class:"line-number"},"32"),c("br"),c("span",{class:"line-number"},"33"),c("br"),c("span",{class:"line-number"},"34"),c("br"),c("span",{class:"line-number"},"35"),c("br"),c("span",{class:"line-number"},"36"),c("br"),c("span",{class:"line-number"},"37"),c("br"),c("span",{class:"line-number"},"38"),c("br"),c("span",{class:"line-number"},"39"),c("br"),c("span",{class:"line-number"},"40"),c("br"),c("span",{class:"line-number"},"41"),c("br"),c("span",{class:"line-number"},"42"),c("br"),c("span",{class:"line-number"},"43"),c("br"),c("span",{class:"line-number"},"44"),c("br"),c("span",{class:"line-number"},"45"),c("br"),c("span",{class:"line-number"},"46"),c("br")])],-1),B=c("h2",{id:"apply的模拟实现",tabindex:"-1"},[l("apply的模拟实现 "),c("a",{class:"header-anchor",href:"#apply的模拟实现","aria-hidden":"true"},"#")],-1),G=c("div",{class:"language-js line-numbers-mode"},[c("pre",null,[c("code",null,[c("span",{class:"token class-name"},"Function"),c("span",{class:"token punctuation"},"."),l("prototype"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function-variable function"},"apply"),l(),c("span",{class:"token operator"},"="),l(),c("span",{class:"token keyword"},"function"),l(),c("span",{class:"token punctuation"},"("),c("span",{class:"token parameter"},[l("context"),c("span",{class:"token punctuation"},","),l(" arr")]),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n  "),c("span",{class:"token comment"},"// var context = Object(context) || window;"),l("\n  "),c("span",{class:"token comment"},"// Object(null) or Object(undefined) 都是{};故这个地方不能用Object(context),否则在没有参数的时候结果不正确"),l("\n  "),c("span",{class:"token keyword"},"var"),l(" context "),c("span",{class:"token operator"},"="),l(" context "),c("span",{class:"token operator"},"||"),l(" window"),c("span",{class:"token punctuation"},";"),l("\n  context"),c("span",{class:"token punctuation"},"."),l("fn "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token keyword"},"this"),c("span",{class:"token punctuation"},";"),l("\n\n  "),c("span",{class:"token keyword"},"var"),l(" result"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token keyword"},"if"),l(),c("span",{class:"token punctuation"},"("),c("span",{class:"token operator"},"!"),l("arr"),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n    result "),c("span",{class:"token operator"},"="),l(" context"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"fn"),c("span",{class:"token punctuation"},"("),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n  "),c("span",{class:"token punctuation"},"}"),l("\n  "),c("span",{class:"token keyword"},"else"),l(),c("span",{class:"token punctuation"},"{"),l("\n    "),c("span",{class:"token keyword"},"var"),l(" args "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token punctuation"},"["),c("span",{class:"token punctuation"},"]"),c("span",{class:"token punctuation"},";"),l("\n    "),c("span",{class:"token keyword"},"for"),l(),c("span",{class:"token punctuation"},"("),c("span",{class:"token keyword"},"var"),l(" i "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token number"},"0"),c("span",{class:"token punctuation"},","),l(" len "),c("span",{class:"token operator"},"="),l(" arr"),c("span",{class:"token punctuation"},"."),l("length"),c("span",{class:"token punctuation"},";"),l(" i "),c("span",{class:"token operator"},"<"),l(" len"),c("span",{class:"token punctuation"},";"),l(" i"),c("span",{class:"token operator"},"++"),c("span",{class:"token punctuation"},")"),l(),c("span",{class:"token punctuation"},"{"),l("\n      args"),c("span",{class:"token punctuation"},"."),c("span",{class:"token function"},"push"),c("span",{class:"token punctuation"},"("),c("span",{class:"token string"},"'arr['"),l(),c("span",{class:"token operator"},"+"),l(" i "),c("span",{class:"token operator"},"+"),l(),c("span",{class:"token string"},"']'"),c("span",{class:"token punctuation"},")"),c("span",{class:"token punctuation"},";"),l("\n    "),c("span",{class:"token punctuation"},"}"),l("\n    result "),c("span",{class:"token operator"},"="),l(),c("span",{class:"token function"},"eval"),c("span",{class:"token punctuation"},"("),c("span",{class:"token string"},"'context.fn('"),l(),c("span",{class:"token operator"},"+"),l(" args "),c("span",{class:"token operator"},"+"),l(),c("span",{class:"token string"},"')'"),c("span",{class:"token punctuation"},")"),l("\n  "),c("span",{class:"token punctuation"},"}"),l("\n\n  "),c("span",{class:"token keyword"},"delete"),l(" context"),c("span",{class:"token punctuation"},"."),l("fn\n  "),c("span",{class:"token keyword"},"return"),l(" result"),c("span",{class:"token punctuation"},";"),l("\n"),c("span",{class:"token punctuation"},"}"),l("\n")])]),c("div",{class:"line-numbers-wrapper"},[c("span",{class:"line-number"},"1"),c("br"),c("span",{class:"line-number"},"2"),c("br"),c("span",{class:"line-number"},"3"),c("br"),c("span",{class:"line-number"},"4"),c("br"),c("span",{class:"line-number"},"5"),c("br"),c("span",{class:"line-number"},"6"),c("br"),c("span",{class:"line-number"},"7"),c("br"),c("span",{class:"line-number"},"8"),c("br"),c("span",{class:"line-number"},"9"),c("br"),c("span",{class:"line-number"},"10"),c("br"),c("span",{class:"line-number"},"11"),c("br"),c("span",{class:"line-number"},"12"),c("br"),c("span",{class:"line-number"},"13"),c("br"),c("span",{class:"line-number"},"14"),c("br"),c("span",{class:"line-number"},"15"),c("br"),c("span",{class:"line-number"},"16"),c("br"),c("span",{class:"line-number"},"17"),c("br"),c("span",{class:"line-number"},"18"),c("br"),c("span",{class:"line-number"},"19"),c("br"),c("span",{class:"line-number"},"20"),c("br"),c("span",{class:"line-number"},"21"),c("br")])],-1);var H=n(r,[["render",function(n,o,c,l,u,r){const H=s("code-block");return p(),a("div",null,[i,t(H,{showAction:!1},{default:e((()=>[k])),_:1}),b,m,d,f,g,t(H,{showAction:!1},{default:e((()=>[v])),_:1}),w,y,t(H,{showAction:!1},{default:e((()=>[h])),_:1}),x,j,t(H,{showAction:!1},{default:e((()=>[_])),_:1}),A,S,t(H,{showAction:!1},{default:e((()=>[F])),_:1}),O,t(H,{showAction:!1},{default:e((()=>[T])),_:1}),E,t(H,{showAction:!1},{default:e((()=>[q])),_:1}),P,C,t(H,{showAction:!1},{default:e((()=>[I])),_:1}),J,V,D,t(H,{showAction:!1},{default:e((()=>[N])),_:1}),R,t(H,{showAction:!1},{default:e((()=>[U])),_:1}),t(H,{showAction:!1},{default:e((()=>[z])),_:1}),B,t(H,{showAction:!1},{default:e((()=>[G])),_:1})])}]]);export{u as __pageData,H as default};
